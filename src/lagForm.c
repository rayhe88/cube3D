// Estructura
//
// val[0] campo en r0
//
// val[1] derivada  x evaluada en r0
// val[2] derivada  y evaluada en r0
// val[3] derivada  z evaluada en r0
//
// val[4] derivada xx evaluada en r0
// val[5] derivada yy evaluada en r0
// val[6] derivada zz evaluada en r0
//
// val[7] derivada xy evaluada en r0
// val[8] derivada xz evaluada en r0
// val[9] derivada yz evaluada en r0
//

// n es el orden de los datos n = pol + 1
//
#include "lagForm.h"

void setVal(double *val) {
    int i;
    for (i = 0; i < 10; i++)
        val[i] = (double)0.;
}
int Ind(int idx, int idy, int idz, int n) {
    return idx * n * n + idy * n + idz;
}

int gradPol01(double hx, double hy, double hz, double *f, double *val) {

    setVal(val);

    val[0] = f[0];
    val[1] = (f[4] - f[0]) / hx;
    val[2] = (f[2] - f[0]) / hy;
    val[3] = (f[1] - f[0]) / hz;

    return 0;
}
int lapPol01(double hx, double hy, double hz, double *f, double *val) {

    setVal(val);

    val[0] = f[0];

    return 0;
}

int hessPol01(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);
    val[0] = f[0];
    val[1] = (f[4] - f[0]) / hx;
    val[2] = (f[2] - f[0]) / hy;
    val[3] = (f[1] - f[0]) / hz;

    val[7] = (f[0] - f[2] - f[4] + f[6]) / (hx * hy);
    val[8] = (f[0] - f[1] - f[4] + f[5]) / (hx * hz);
    val[9] = (f[0] - f[1] - f[2] + f[3]) / (hy * hz);

    return 0;
}
/*****************************************************************************/
int gradPol02(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[13];
    val[1] = (f[22] - f[4]) / (2. * hx);
    val[2] = (f[16] - f[10]) / (2. * hy);
    val[3] = (f[14] - f[12]) / (2. * hz);

    return 0;
}
int lapPol02(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[13];
    val[4] = (f[4] - 2. * f[13] + f[22]) / (hx * hx);
    val[5] = (f[10] - 2. * f[13] + f[16]) / (hy * hy);
    val[6] = (f[12] - 2. * f[13] + f[14]) / (hz * hz);

    return 0;
}
int hessPol02(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[13];
    val[1] = (f[22] - f[4]) / (2. * hx);
    val[2] = (f[16] - f[10]) / (2. * hy);
    val[3] = (f[14] - f[12]) / (2. * hz);
    val[4] = (f[4] - 2. * f[13] + f[22]) / (hx * hx);
    val[5] = (f[10] - 2. * f[13] + f[16]) / (hy * hy);
    val[6] = (f[12] - 2. * f[13] + f[14]) / (hz * hz);
    val[7] = (f[1] - f[7] - f[19] + f[25]) / (4. * hx * hy);
    val[8] = (f[3] - f[5] - f[21] + f[23]) / (4. * hx * hz);
    val[9] = (f[9] - f[11] - f[15] + f[17]) / (4. * hy * hz);

    return 0;
}
/*****************************************************************************/
int gradPol03(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);
    val[0] = f[21];
    val[1] = -(2. * f[5] + 3. * f[21] - 6. * f[37] + f[53]) / (6. * hx);
    val[2] = -(2. * f[17] + 3. * f[21] - 6. * f[25] + f[29]) / (6. * hy);
    val[3] = -(2. * f[20] + 3. * f[21] - 6. * f[22] + f[23]) / (6. * hz);

    return 0;
}
int lapPol03(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[21];
    val[4] = (f[5] - 2. * f[21] + f[37]) / (hx * hx);
    val[5] = (f[17] - 2. * f[21] + f[25]) / (hy * hy);
    val[6] = (f[20] - 2. * f[21] + f[22]) / (hz * hz);

    return 0;
}
int hessPol03(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[21];
    val[1] = -(2. * f[5] + 3. * f[21] - 6. * f[37] + f[53]) / (6. * hx);
    val[2] = -(2. * f[17] + 3. * f[21] - 6. * f[25] + f[29]) / (6. * hy);
    val[3] = -(2. * f[20] + 3. * f[21] - 6. * f[22] + f[23]) / (6. * hz);
    val[4] = (f[5] - 2. * f[21] + f[37]) / (hx * hx);
    val[5] = (f[17] - 2. * f[21] + f[25]) / (hy * hy);
    val[6] = (f[20] - 2. * f[21] + f[22]) / (hz * hz);

    val[7] = 4. * f[1] + 6. * f[5] - 12. * f[9] + 2. * f[13] + 6. * f[17] +
             9. * f[21] - 18. * f[25] + 3. * f[29] - 12. * f[33] - 18. * f[37] +
             36. * f[41] - 6. * f[45] + 2. * f[49] + 3. * f[53] - 6. * f[57] +
             f[61];

    val[8] = 4. * f[4] + 6. * f[5] - 12. * f[6] + 2. * f[7] + 6. * f[20] +
             9. * f[21] - 18. * f[22] + 3. * f[23] - 12. * f[36] - 18. * f[37] +
             36. * f[38] - 6. * f[39] + 2. * f[52] + 3. * f[53] - 6. * f[54] +
             f[55];

    val[9] = 4. * f[16] + 6. * f[17] - 12. * f[18] + 2. * f[19] + 6. * f[20] +
             9. * f[21] - 18. * f[22] + 3. * f[23] - 12. * f[24] - 18. * f[25] +
             36. * f[26] - 6. * f[27] + 2. * f[28] + 3. * f[29] - 6. * f[30] +
             f[31];

    val[7] /= (36. * hx * hy);
    val[8] /= (36. * hx * hz);
    val[9] /= (36. * hy * hz);

    return 0;
}
/*****************************************************************************/
int gradPol04(double hx, double hy, double hz, double *f, double *val) {

    setVal(val);
    val[0] = f[62];
    val[1] = (f[12] - 8. * f[37] + 8. * f[87] - f[112]) / (12. * hx);
    val[2] = (f[52] - 8. * f[57] + 8. * f[67] - f[72]) / (12. * hy);
    val[3] = (f[60] - 8. * f[61] + 8. * f[63] - f[64]) / (12. * hz);

    return 0;
}
int lapPol04(double hx, double hy, double hz, double *f, double *val) {

    setVal(val);
    val[0] = f[62];
    val[4] = -(f[12] - 16. * f[37] + 30. * f[62] - 16. * f[87] + f[112]) /
             (12. * hx * hx);
    val[5] = -(f[52] - 16. * f[57] + 30. * f[62] - 16. * f[67] + f[72]) /
             (12. * hy * hy);
    val[6] = -(f[60] - 16. * f[61] + 30. * f[62] - 16. * f[63] + f[64]) /
             (12. * hz * hz);

    return 0;
}
int hessPol04(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[62];
    val[1] = (f[12] - 8. * f[37] + 8. * f[87] - f[112]) / (12. * hx);
    val[2] = (f[52] - 8. * f[57] + 8. * f[67] - f[72]) / (12. * hy);
    val[3] = (f[60] - 8. * f[61] + 8. * f[63] - f[64]) / (12. * hz);

    val[4] = -(f[12] - 16. * f[37] + 30. * f[62] - 16. * f[87] + f[112]) /
             (12. * hx * hx);
    val[5] = -(f[52] - 16. * f[57] + 30. * f[62] - 16. * f[67] + f[72]) /
             (12. * hy * hy);
    val[6] = -(f[60] - 16. * f[61] + 30. * f[62] - 16. * f[63] + f[64]) /
             (12. * hz * hz);

    val[7] = f[2] - 8. * f[7] + 8. * f[17] - f[22] - 8. * f[27] + 64. * f[32] -
             64. * f[42] + 8. * f[47] + 8. * f[77] - 64. * f[82] + 64. * f[92] -
             8. * f[97] - f[102] + 8. * f[107] - 8. * f[117] + f[122];

    val[8] = f[10] - 8. * f[11] + 8. * f[13] - f[14] - 8. * f[35] +
             64. * f[36] - 64. * f[38] + 8. * f[39] + 8. * f[85] - 64. * f[86] +
             64. * f[88] - 8. * f[89] - f[110] + 8. * f[111] - 8. * f[113] +
             f[114];

    val[9] = f[50] - 8. * f[51] + 8. * f[53] - f[54] - 8. * f[55] +
             64. * f[56] - 64. * f[58] + 8. * f[59] + 8. * f[65] - 64. * f[66] +
             64. * f[68] - 8. * f[69] - f[70] + 8. * f[71] - 8. * f[73] + f[74];

    val[7] /= (144. * hx * hy);
    val[8] /= (144. * hx * hz);
    val[9] /= (144. * hy * hz);

    return 0;
}
/**************************************************106***************************/
int gradPol05(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);
    val[0] = f[86];
    val[1] = 3. * f[14] + 2. * f[194] -
             5. * (6. * f[50] + 4. * f[86] - 12. * f[122] + 3. * f[158]);

    val[2] = 3. * f[74] + 2. * f[104] -
             5. * (6. * f[80] + 4. * f[86] - 12. * f[92] + 3. * f[98]);

    val[3] = 3. * f[84] + 2. * f[89] -
             5. * (6. * f[85] + 4. * f[86] - 12. * f[87] + 3. * f[88]);

    val[1] /= (60. * hx);
    val[2] /= (60. * hy);
    val[3] /= (60. * hz);

    return 0;
}
int lapPol05(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);
    val[0] = f[86];

    val[4] = -(f[14] - 16. * f[50] + 30. * f[86] - 16. * f[122] + f[158]);
    val[5] = -(f[74] - 16. * f[80] + 30. * f[86] - 16. * f[92] + f[98]);
    val[6] = -(f[84] - 16. * f[85] + 30. * f[86] - 16. * f[87] + f[88]);

    val[4] /= (12. * hx * hx);
    val[5] /= (12. * hy * hy);
    val[6] /= (12. * hz * hz);

    return 0;
}
int hessPol05(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[86];
    val[1] = 3. * f[14] + 2. * f[194] -
             5. * (6. * f[50] + 4. * f[86] - 12. * f[122] + 3. * f[158]);

    val[2] = 3. * f[74] + 2. * f[104] -
             5. * (6. * f[80] + 4. * f[86] - 12. * f[92] + 3. * f[98]);

    val[3] = 3. * f[84] + 2. * f[89] -
             5. * (6. * f[85] + 4. * f[86] - 12. * f[87] + 3. * f[88]);

    val[1] /= (60. * hx);
    val[2] /= (60. * hy);
    val[3] /= (60. * hz);

    val[4] = -(f[14] - 16. * f[50] + 30. * f[86] - 16. * f[122] + f[158]);
    val[5] = -(f[74] - 16. * f[80] + 30. * f[86] - 16. * f[92] + f[98]);
    val[6] = -(f[84] - 16. * f[85] + 30. * f[86] - 16. * f[87] + f[88]);

    val[4] /= (12. * hx * hx);
    val[5] /= (12. * hy * hy);
    val[6] /= (12. * hz * hz);

    val[7] = 9. * f[2] - 90. * f[8] - 60. * f[14] + 180. * f[20] - 45. * f[26] +
             6. * f[32] - 90. * f[38] + 900. * f[44] + 600. * f[50] -
             1800. * f[56] + 450. * f[62] - 60. * f[68] - 60. * f[74] +
             600. * f[80] + 400. * f[86] - 1200. * f[92] + 300. * f[98] -
             40. * f[104] + 180. * f[110] - 1800. * f[116] - 1200. * f[122] +
             3600. * f[128] - 900. * f[134] + 120. * f[140] - 45. * f[146] +
             450. * f[152] + 300. * f[158] - 900. * f[164] + 225. * f[170] -
             30. * f[176] + 6. * f[182] - 60. * f[188] - 40. * f[194] +
             120. * f[200] - 30. * f[260] + 4. * f[212];

    val[8] = 9. * f[12] - 90. * f[13] - 60. * f[14] + 180. * f[15] -
             45. * f[16] + 6. * f[17] - 90. * f[48] + 900. * f[49] +
             600. * f[50] - 1800. * f[51] + 450. * f[52] - 60. * f[53] -
             60. * f[84] + 600. * f[85] + 400. * f[86] - 1200. * f[87] +
             300. * f[88] - 40. * f[89] + 180. * f[120] - 1800. * f[121] -
             1200. * f[122] + 3600. * f[123] - 900. * f[124] + 120. * f[125] -
             45. * f[156] + 450. * f[157] + 300. * f[158] - 900. * f[159] +
             225. * f[160] - 30. * f[161] + 6. * f[192] - 60. * f[193] -
             40. * f[194] + 120. * f[195] - 30. * f[196] + 4. * f[197];

    val[9] = 9. * f[72] - 90. * f[73] - 60. * f[74] + 180. * f[75] -
             45. * f[76] + 6. * f[77] - 90. * f[78] + 900. * f[79] +
             600. * f[80] - 1800. * f[81] + 450. * f[82] - 60. * f[83] -
             60. * f[84] + 600. * f[85] + 400. * f[86] - 1200. * f[87] +
             300. * f[88] - 40. * f[89] + 180. * f[90] - 1800. * f[91] -
             1200. * f[92] + 3600. * f[93] - 900. * f[94] + 120. * f[95] -
             45. * f[96] + 450. * f[97] + 300. * f[98] - 900. * f[99] +
             225. * f[100] - 30. * f[101] + 6. * f[102] - 60. * f[103] -
             40. * f[104] + 120. * f[105] - 30. * f[106] + 4. * f[107];

    val[7] /= (3600. * hx * hy);
    val[8] /= (3600. * hx * hz);
    val[9] /= (3600. * hy * hz);

    return 0;
}

/*****************************************************************************/
int gradPol06(double hx, double hy, double hz, double *f, double *val) {

    setVal(val);
    val[0] = f[171];

    val[1] = -f[24] + 9. * f[73] - 45. * f[122] + 45. * f[220] - 9. * f[269] +
             f[318];
    val[2] = -f[150] + 9. * f[157] - 45. * f[164] + 45. * f[178] - 9. * f[185] +
             f[192];
    val[3] = -f[168] + 9. * f[169] - 45. * f[170] + 45. * f[172] - 9. * f[173] +
             f[174];

    val[1] /= (60. * hx);
    val[2] /= (60. * hy);
    val[3] /= (60. * hz);

    return 0;
}
int lapPol06(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[171];

    val[4] = (2. * f[24] - 27. * f[73] + 270. * f[122] - 490. * f[171] +
              270. * f[220] - 27. * f[269] + 2. * f[318]) /
             (180. * hx * hx);

    val[5] = (2. * f[150] - 27. * f[157] + 270. * f[164] - 490. * f[171] +
              270. * f[178] - 27. * f[185] + 2. * f[192]) /
             (180. * hy * hy);

    val[6] = (2. * f[168] - 27. * f[169] + 270. * f[170] - 490. * f[171] +
              270. * f[172] - 27. * f[173] + 2. * f[174]) /
             (180. * hz * hz);

    return 0;
}
int hessPol06(double hx, double hy, double hz, double *f, double *val) {
    setVal(val);

    val[0] = f[171];

    val[1] = -f[24] + 9. * f[73] - 45. * f[122] + 45. * f[220] - 9. * f[269] +
             f[318];
    val[2] = -f[150] + 9. * f[157] - 45. * f[164] + 45. * f[178] - 9. * f[185] +
             f[192];
    val[3] = -f[168] + 9. * f[169] - 45. * f[170] + 45. * f[172] - 9. * f[173] +
             f[174];
    val[1] /= (60. * hx);
    val[2] /= (60. * hy);
    val[3] /= (60. * hz);

    val[4] = (2. * f[24] - 27. * f[73] + 270. * f[122] - 490. * f[171] +
              270. * f[220] - 27. * f[269] + 2. * f[318]) /
             (180. * hx * hx);

    val[5] = (2. * f[150] - 27. * f[157] + 270. * f[164] - 490. * f[171] +
              270. * f[178] - 27. * f[185] + 2. * f[192]) /
             (180. * hy * hy);

    val[6] = (2. * f[168] - 27. * f[169] + 270. * f[170] - 490. * f[171] +
              270. * f[172] - 27. * f[173] + 2. * f[174]) /
             (180. * hz * hz);

    val[7] = f[3] - 9. * f[10] + 45. * f[17] - 45. * f[31] + 9. * f[38] -
             f[45] - 9. * f[52] + 81. * f[59] - 405. * f[66] + 405. * f[80] -
             81. * f[87] + 9. * f[94] + 45. * f[101] - 405. * f[108] +
             2025. * f[115] - 2025. * f[129] + 405. * f[136] - 45. * f[143] -
             45. * f[199] + 405. * f[206] - 2025. * f[213] + 2025. * f[227] -
             405. * f[234] + 45. * f[241] + 9. * f[248] - 81. * f[255] +
             405. * f[262] - 405. * f[276] + 81. * f[283] - 9. * f[290] -
             f[297] + 9. * f[304] - 45. * f[311] + 45. * f[325] - 9. * f[332] +
             f[339];

    val[8] = f[21] - 9. * f[22] + 45. * f[23] - 45. * f[25] + 9. * f[26] -
             f[27] - 9. * f[70] + 81. * f[71] - 405. * f[72] + 405. * f[74] -
             81. * f[75] + 9. * f[76] + 45. * f[119] - 405. * f[120] +
             2025. * f[121] - 2025. * f[123] + 405. * f[124] - 45. * f[125] -
             45. * f[217] + 405. * f[218] - 2025. * f[219] + 2025. * f[221] -
             405. * f[222] + 45. * f[223] + 9. * f[266] - 81. * f[267] +
             405. * f[268] - 405. * f[270] + 81. * f[271] - 9. * f[272] -
             f[315] + 9. * f[316] - 45. * f[317] + 45. * f[319] - 9. * f[320] +
             f[321];

    val[9] = f[147] - 9. * f[148] + 45. * f[149] - 45. * f[151] + 9. * f[152] -
             f[153] - 9. * f[154] + 81. * f[155] - 405. * f[156] +
             405. * f[158] - 81. * f[159] + 9. * f[160] + 45. * f[161] -
             405. * f[162] + 2025. * f[163] - 2025. * f[165] + 405. * f[166] -
             45. * f[167] - 45. * f[175] + 405. * f[176] - 2025. * f[177] +
             2025. * f[179] - 405. * f[180] + 45. * f[181] + 9. * f[182] -
             81. * f[183] + 405. * f[184] - 405. * f[186] + 81. * f[187] -
             9. * f[188] - f[189] + 9. * f[190] - 45. * f[191] + 45. * f[193] -
             9. * f[194] + f[195];

    val[7] /= (3600. * hx * hy);
    val[8] /= (3600. * hx * hz);
    val[9] /= (3600. * hy * hz);

    return 0;
}
